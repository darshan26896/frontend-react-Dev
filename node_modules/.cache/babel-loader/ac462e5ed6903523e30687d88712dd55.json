{"ast":null,"code":"import _regeneratorRuntime from \"/home/shivanee/Downloads/ETM-project/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/home/shivanee/Downloads/ETM-project/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _marked = /*#__PURE__*/_regeneratorRuntime.mark(saga);\nimport { persistReducer } from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\nimport { put, takeLatest } from \"redux-saga/effects\";\n//import { getUserByToken } from \"./authCrud\";\n\nexport var actionTypes = {\n  Login: \"[Login] Action\",\n  Logout: \"[Logout] Action\",\n  Register: \"[Register] Action\",\n  UserRequested: \"[Request User] Action\",\n  UserLoaded: \"[Load User] Auth API\",\n  SetUser: \"[Set User] Action\"\n};\nvar initialAuthState = {\n  user: undefined,\n  authToken: undefined\n};\nexport var reducer = persistReducer({\n  storage: storage,\n  key: \"v726-demo1-auth\",\n  whitelist: [\"authToken\"]\n}, function () {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialAuthState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case actionTypes.Login:\n      {\n        var authToken = action.payload.authToken;\n        console.log(action.payload, \"authtoken\");\n        return {\n          authToken: authToken,\n          user: undefined\n        };\n      }\n    case actionTypes.Register:\n      {\n        var _authToken = action.payload.authToken;\n        return {\n          authToken: _authToken,\n          user: undefined\n        };\n      }\n    case actionTypes.Logout:\n      {\n        // TODO: Change this code. Actions in reducer aren't allowed.\n        return initialAuthState;\n      }\n    case actionTypes.UserLoaded:\n      {\n        var user = action.payload.user;\n        return _objectSpread(_objectSpread({}, state), {}, {\n          user: user\n        });\n      }\n    case actionTypes.SetUser:\n      {\n        var _user = action.payload.user;\n        return _objectSpread(_objectSpread({}, state), {}, {\n          user: _user\n        });\n      }\n    default:\n      return state;\n  }\n});\nexport var actions = {\n  login: function login(authToken) {\n    return {\n      type: actionTypes.Login,\n      payload: {\n        authToken: authToken\n      }\n    };\n  },\n  register: function register(authToken) {\n    return {\n      type: actionTypes.Register,\n      payload: {\n        authToken: authToken\n      }\n    };\n  },\n  logout: function logout() {\n    return {\n      type: actionTypes.Logout\n    };\n  },\n  requestUser: function requestUser(user) {\n    return {\n      type: actionTypes.UserRequested,\n      payload: {\n        user: user\n      }\n    };\n  },\n  fulfillUser: function fulfillUser(user) {\n    return {\n      type: actionTypes.UserLoaded,\n      payload: {\n        user: user\n      }\n    };\n  },\n  setUser: function setUser(user) {\n    return {\n      type: actionTypes.SetUser,\n      payload: {\n        user: user\n      }\n    };\n  }\n};\nexport function saga() {\n  return _regeneratorRuntime.wrap(function saga$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return takeLatest(actionTypes.Login, /*#__PURE__*/_regeneratorRuntime.mark(function loginSaga() {\n            return _regeneratorRuntime.wrap(function loginSaga$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return put(actions.requestUser());\n                  case 2:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, loginSaga);\n          }));\n        case 2:\n          _context4.next = 4;\n          return takeLatest(actionTypes.Register, /*#__PURE__*/_regeneratorRuntime.mark(function registerSaga() {\n            return _regeneratorRuntime.wrap(function registerSaga$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _context2.next = 2;\n                    return put(actions.requestUser());\n                  case 2:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, registerSaga);\n          }));\n        case 4:\n          _context4.next = 6;\n          return takeLatest(actionTypes.UserRequested, /*#__PURE__*/_regeneratorRuntime.mark(function userRequested() {\n            var chekUser, token, userval;\n            return _regeneratorRuntime.wrap(function userRequested$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    //const { data: user } = yield getUserByToken();\n                    chekUser = localStorage.getItem(\"user\");\n                    token = JSON.parse(chekUser).accessToken;\n                    userval = JSON.parse(chekUser).user;\n                    _context3.next = 5;\n                    return put(actions.fulfillUser(userval));\n                  case 5:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, userRequested);\n          }));\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked);\n}","map":{"version":3,"names":["saga","persistReducer","storage","put","takeLatest","actionTypes","Login","Logout","Register","UserRequested","UserLoaded","SetUser","initialAuthState","user","undefined","authToken","reducer","key","whitelist","state","arguments","length","action","type","payload","console","log","_objectSpread","actions","login","register","logout","requestUser","fulfillUser","setUser","_regeneratorRuntime","wrap","saga$","_context4","prev","next","mark","loginSaga","loginSaga$","_context","stop","registerSaga","registerSaga$","_context2","userRequested","chekUser","token","userval","userRequested$","_context3","localStorage","getItem","JSON","parse","accessToken","_marked"],"sources":["/home/shivanee/Downloads/ETM-project/react/src/app/modules/Auth/_redux/authRedux.js"],"sourcesContent":["import { persistReducer } from \"redux-persist\";\r\nimport storage from \"redux-persist/lib/storage\";\r\nimport { put, takeLatest } from \"redux-saga/effects\";\r\n//import { getUserByToken } from \"./authCrud\";\r\n\r\nexport const actionTypes = {\r\n  Login: \"[Login] Action\",\r\n  Logout: \"[Logout] Action\",\r\n  Register: \"[Register] Action\",\r\n  UserRequested: \"[Request User] Action\",\r\n  UserLoaded: \"[Load User] Auth API\",\r\n  SetUser: \"[Set User] Action\",\r\n};\r\n\r\nconst initialAuthState = {\r\n  user: undefined,\r\n  authToken: undefined,\r\n};\r\n\r\nexport const reducer = persistReducer(\r\n  { storage, key: \"v726-demo1-auth\", whitelist: [\"authToken\"] },\r\n  (state = initialAuthState, action) => {\r\n    switch (action.type) {\r\n      case actionTypes.Login: {\r\n        const { authToken } = action.payload;\r\n        console.log(action.payload, \"authtoken\");\r\n        return { authToken, user: undefined };\r\n      }\r\n\r\n      case actionTypes.Register: {\r\n        const { authToken } = action.payload;\r\n\r\n        return { authToken, user: undefined };\r\n      }\r\n\r\n      case actionTypes.Logout: {\r\n        // TODO: Change this code. Actions in reducer aren't allowed.\r\n        return initialAuthState;\r\n      }\r\n\r\n      case actionTypes.UserLoaded: {\r\n        const { user } = action.payload;\r\n        return { ...state, user };\r\n      }\r\n\r\n      case actionTypes.SetUser: {\r\n        const { user } = action.payload;\r\n        return { ...state, user };\r\n      }\r\n\r\n      default:\r\n        return state;\r\n    }\r\n  }\r\n);\r\n\r\nexport const actions = {\r\n  login: (authToken) => ({ type: actionTypes.Login, payload: { authToken } }),\r\n  register: (authToken) => ({\r\n    type: actionTypes.Register,\r\n    payload: { authToken },\r\n  }),\r\n  logout: () => ({ type: actionTypes.Logout }),\r\n  requestUser: (user) => ({\r\n    type: actionTypes.UserRequested,\r\n    payload: { user },\r\n  }),\r\n  fulfillUser: (user) => ({ type: actionTypes.UserLoaded, payload: { user } }),\r\n  setUser: (user) => ({ type: actionTypes.SetUser, payload: { user } }),\r\n};\r\n\r\nexport function* saga() {\r\n  yield takeLatest(actionTypes.Login, function* loginSaga() {\r\n    yield put(actions.requestUser());\r\n  });\r\n\r\n  yield takeLatest(actionTypes.Register, function* registerSaga() {\r\n    yield put(actions.requestUser());\r\n  });\r\n\r\n  yield takeLatest(actionTypes.UserRequested, function* userRequested() {\r\n    //const { data: user } = yield getUserByToken();\r\n    const chekUser = localStorage.getItem(\"user\");\r\n    const token = JSON.parse(chekUser).accessToken;\r\n    const userval = JSON.parse(chekUser).user;\r\n    yield put(actions.fulfillUser(userval));\r\n  });\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}